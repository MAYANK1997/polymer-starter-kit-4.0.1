// ---------------- Mutation ----------------
const createOrUpdateMutation = useMutation({
  mutationFn: async (data: CategoryFormData) => {
    // Transform the form data into backend payload format
    const payload = {
      ...(mode === "edit" && { id: category?.id }), // include id only in edit
      name: data.restrictionCategoryName,
      description: data.description,
      groupNames: data.availableFor,
      funds: fundGroups
        .filter((fg) => data.fundGroup.includes(fg.fundGroupName))
        .flatMap((fg) =>
          fg.funds
            .filter((f) => data.fundNames.includes(f.fundName))
            .map((f) => ({
              fundGroupName: fg.fundGroupName,
              fundName: f.fundName,
              enfusionFundId: f.enfusionFundId,
            }))
        ),
    };

    const response = await fetch(`${config.apis.mdmApi}/RestrictionCategory`, {
      method: mode === "edit" ? "PUT" : "POST", // ðŸ‘ˆ switch dynamically
      credentials: "include",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify(payload),
    });

    if (!response.ok) {
      throw new Error("Failed to save Restriction Category");
    }
    return response.json();
  },
  ...
});
