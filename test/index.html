import { Controller, useForm } from "react-hook-form";
import {
  Select,
  Spinner,
  createListCollection,
} from "@chakra-ui/react";

// inside your component...
const { control } = useForm<IssuerFormData>();

// build collection from your categories
const collection = createListCollection({
  items: state.value ?? [],
  itemToString: (item) => item.name,
  itemToValue: (item) => item.name,
});

<Controller
  name="categoryName"
  control={control}
  render={({ field }) => (
    <Select.Root
      collection={collection}
      value={collection.items.find(
        (c) => c.name === field.value
      )}
      onValueChange={(item) => field.onChange(item?.name)}
    >
      <Select.HiddenSelect />
      <Select.Label>Restriction Category</Select.Label>
      <Select.Control>
        <Select.Trigger>
          <Select.ValueText placeholder="Select Below" />
        </Select.Trigger>
        <Select.IndicatorGroup>
          {state.loading && (
            <Spinner
              size="xs"
              borderWidth="1.5px"
              color="fg.muted"
            />
          )}
          <Select.Indicator />
        </Select.IndicatorGroup>
      </Select.Control>
      <Select.Positioner>
        <Select.Content>
          {collection.items.map((categories) => (
            <Select.Item
              item={categories} // âœ… pass the whole object, not string
              key={categories.name}
            >
              {categories.name}
              <Select.ItemIndicator />
            </Select.Item>
          ))}
        </Select.Content>
      </Select.Positioner>
    </Select.Root>
  )}
/>
